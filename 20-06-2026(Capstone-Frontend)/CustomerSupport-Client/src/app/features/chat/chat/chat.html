<div class="relative w-full h-[80vh] flex flex-col">

    <div #scrollContainer class="p-4 space-y-2 overflow-y-auto grow">
        @if(chatMessages.length > 0){
        @for (msg of chatMessages; track $index) {
        <div [ngClass]="msg.userId === chat?.agent?.email ? 'text-left' : 'text-right'">
            <div [ngClass]="msg.userId === chat?.agent?.email 
                ? 'inline-block bg-gray-200 text-black rounded-lg p-3 max-w-xs'
                : 'inline-block bg-blue-500 text-white rounded-lg p-3 max-w-xs'">
                <p *ngIf="msg.message">{{ msg.message }}</p>
                <img *ngIf="msg.imageName" [src]="msg.image" alt={{msg.imageName}} class="mt-2 max-w-xs rounded" />
                <span class="block text-xs mt-1 text-gray-400">{{ msg.createdAt | date:'shortTime' }}</span>
            </div>
        </div>
        }
        }
        @else {
        <div class="text-center pt-5">No Messages yet..</div>
        }
    </div>

    <div class="w-full px-8 py-3 shrink-0 flex items-center gap-4 bg-white shadow-lg border-gray-300 rounded-2xl p-5">
        <lucide-icon name="upload" strokeWidth="2"
            class="w-8 h-8 fill-gray-50 stroke-blue-500 cursor-pointer"></lucide-icon>
        <input type="text" placeholder="Type to send message..." [(ngModel)]="message"
            class="input rounded-xl w-full placeholder:text-gray-400" />
        <div (click)="onSendMessage()">
            <lucide-icon name="send-horizontal" strokeWidth="1"
                class="w-10 h-10 fill-blue-500 stroke-gray-50 cursor-pointer"></lucide-icon>
        </div>
    </div>
</div>